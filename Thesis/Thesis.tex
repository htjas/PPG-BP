\documentclass[12pt, bibliography=totoc]{scrartcl}
\title{Predicting Blood Pressure from Photoplethysmogram Waveform Data: A Signal Processing and
Machine Learning Approach}
\author{Hugas Jasinskas}
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{url}
\usepackage{setspace}
\usepackage{tabto}
\usepackage[export]{adjustbox}
\usepackage{float}
\usepackage[utf8]{inputenc}
\usepackage{csquotes}

\begin{document}

    \begin{titlepage}
        \begin{center}
            \vspace*{1cm}
            \begin{figure}[h]
                \centering
                \includegraphics[scale=0.6]{images/hs/hd}
                \includegraphics[scale=1]{images/hs/hhn}
                \includegraphics[scale=0.06]{images/hs/tmu}
                \label{fig:unis}
            \end{figure}

            \vspace*{1cm}

            \Huge
            \textbf{Master's Thesis}

            \vspace{0.5cm}
            \Large
            Medical Informatics Master

            \vspace{0.5cm}
            \Large
            Universit√§t Heidelberg / Hochschule Heilbronn

            \vspace{0.5cm}
            \Large
            in Cooperation with Taipei Medical University

            \hrulefill

            \vspace{1cm}

            \Huge
            \textbf{Predicting Blood Pressure from Photoplethysmogram Waveform Data: A Signal Processing and
            Machine Learning Approach}

        \end{center}

        \vfill
        \Large
        \noindent
        Supervisor: \tab\hspace{-2cm} Prof.\ Dr. Rolf Bendl\\
        Co-Supervisor: \tab\hspace{-2cm} Prof.\ Dr. Syed Abdul Shabbir\\
        Submitted by: \tab\hspace{-2cm} Hugas Jasinskas\\
        Matriculation number: \tab\hspace{-2cm} 202509\\
        Submitted on: \tab\hspace{-2cm} \today{}\\

    \end{titlepage}

    \newpage

    \begin{Huge}
        \centerline{Affidavit}
    \end{Huge}

    \vspace{2cm}

    \begin{Large}

        I hereby declare under oath that I have independently prepared the present work without using sources other than those indicated; any thoughts taken directly or indirectly from external sources (including electronic sources) are identified as such.

        The work has not been submitted to any examination authority, either domestic or foreign, in the same or similar form, and has not been published.

    \end{Large}

    \vfill

    \rule{4cm}{0.5mm} \tab \rule{4cm}{0.5mm}

    Place, Date \tab Signature

    \newpage

    \tableofcontents

    \newpage
    \onehalfspacing


    \section{Abstract}\label{sec:abstract}


    \section{Introduction}
    \label{sec:introduction}
    \input{introduction}


    \section{Theoretical Background}
    \label{sec:background}
    \input{theoretical-background}


    \section{Methods}
    \label{sec:methods}

    \begin{enumerate}

        \item Data fetching and reading using WFDB and NumPy libraries.

        \subitem Get all available data from MIMIC-IV DB.\
        \subitem This data is used as the validation dataset, since it is the one that's most up-to-date,
        most modern, and supposedly most reliable
        \subitem There are 198 subjects and 200 total studies in the DB (two subjects have two separate studies)
        \subitem The studies contain records with various signals (ECG, ABP, Pleth etc.) and are of different lengths
        \subitem A single record can contain various segments also of different lengths and signals
        \subitem Segments contain continuous values, that are used in this research
        \subitem Only segments with at least 10 minutes of length are considered
        \subitem These segments must also not contain \enquote{faulty} values
        \subitem Faulty values: NaN, inf, negative values, for ABP values not below 30 and not above 250,
        for PPG only between 0 and 1
        \subitem If a 10-minute part of the segment matches these criteria, it is saved to the ./validation directory,
        as 2 separate and synchronous ABP and PPG files
        \subitem If a segment is longer than 10 minutes, then more 10 minute segments may be extracted
        (marked by a \_ and a number representing the sequence)
        \subitem Example of the files: \texttt{abp\_80057524\_0005\_0}, \texttt{ppg\_80057524\_0020\_18}

        For MIMIC-IV data fetching, no limits on the total records and single study records are given.
        For MIMIC-III - 4 times the records of MIMIC-IV are fetched and a maximum of 100 segments per study is set,
        to avoid over-representation of single person or study data in the ML part of the research.

        \item Digital signal filtering using Savitzky-Golay and Butterworth Lowpass filters.

        \item Beat detection algorithms from MIMIC WFDB Tutorial used for primary estimation.
        Beat detection improved with manual implementation of SciPy library.

        \item Fiducial Point calculation based on the algorithm provided in the MIMIC WFDB Tutorial.

        \item Feature extraction with personally created code to extract time domain features, and NumPy library to extract frequency domain features (FFT). Median value calculation using NumPy library.

        \item Machine Learning Model creation using PyTorch and Scikit-Learn libraries.

    \end{enumerate}


    \section{Results}
    \label{sec:results}

    \subsection{Data Fetching}
    \label{subsec:data_fetching}

    Data for Validation from MIMIC4:
    5508 records each containing 37795 values corresponding to ~605 seconds (fs=64.4725);

    Data for Training/Testing from MIMIC3 (1st Iteration):
    22083 (~4*MIMIC4) records each containing 75625 values corresponding to 605 seconds (fs=125);

    \subsection{Data Processing}
    \label{subsec:data_processing}

    Same Signaling processing approaches were included (see 4.2) for both the MIMIC4 and MIMIC3 data.

    \subsection{Feature Extraction}
    \label{subsec:feature_extraction}

    CAVE: out of the 34 features, 2 (delta T and resistive index) depend on the accurate detection of the dicrotic notch.
    Significantly more values can be extracted if finding the dicrotic notch would not be necessary

    FE from MIMIC4 for Validation:
    - For target reference Systolic, Diastolic and MAP values were extracted from the waveform data.
    - For Machine Learning, 34 features were extracted from the PPG waveform
    A total of \textbf{1,309,265} values were extracted, resulting in a 34 x 1,309,265 matrix.
    Total of \textbf{183,140} median values were extracted.

    FE from MIMIC3 for Training/Testing:

    - For target reference ABP Systolic, Diastolic and MAP values were extracted from the waveform data.
    - For Machine Learning, 34 features were extracted from the PPG waveform
    A total of \textbf{13,659,375} values were extracted, resulting in a 34 x 13659375 matrix.
    Total of \textbf{1,918,623} median values were extracted.

    The summarized results are displayed in Figure~\ref{fig:data_flow}.

    \begin{figure}[h]
        \centering
        \includegraphics[scale=0.6]{images/flow_diagrams/flow_diagram}
        \caption{Flow Diagram presenting the Data Fetching and Processing}
        \label{fig:data_flow}
    \end{figure}

    \subsection{Machine Learning}
    \label{subsec:machine_learning}


    \section{Discussion}
    \label{sec:discussion}

    Limitations:
    - not knowing what devices were used
    - how they were calibrated
    - how accurate they are
    - pulse oximeter and arterial catheter parameters
    - sampling rates are different for every device (even between MIMIC 3 and 4)

    Possible Improvements:
    - integrate both the ECG and PPG graphs for a more precise prediction
    - use further signal processing approaches
    - manually filter waveform graphics (e.g.\ faulty PPG signal)
    - expand on machine learning algorithms
    - experiment with different median intervals


    \section{Conclusion}
    \label{sec:conclusion}

    \newpage

    \bibliographystyle{plain}
    \bibliography{literature}

\end{document}